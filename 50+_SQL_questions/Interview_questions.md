Got it ✅
I’ll extend the **SQL for Data Engineering – Exam Prep Cheatsheet** with **50+ fresh, non-repetitive SQL interview questions** — no repeats from the first cheatsheet.

These will focus on **data engineering, big data, performance optimization, ETL workflows, and analytical SQL** questions you could face in a **certification exam or a job interview**.

---

# 🎯 **50+ SQL Interview Questions for Data Engineering**

*(Add-on to the original cheatsheet — no repeats)*

---

## 1️⃣ **Schema & Table Design**

1. What’s the difference between **PRIMARY KEY** and **UNIQUE** constraints?
2. How would you design a table for a **slowly changing dimension (SCD) Type 2**?
3. Explain the difference between **normalized** and **denormalized** database designs.
4. What is a **surrogate key** and when would you use one?
5. How do you enforce **referential integrity** in a relational database?

---

## 2️⃣ **Advanced Joins & Set Operations**

6. What’s the difference between **UNION** and **UNION ALL**?
7. How would you write a query to find records in **table A** but not in **table B**?
8. Explain when you’d use a **FULL OUTER JOIN** instead of `LEFT` or `RIGHT` join.
9. How do you detect and remove **duplicate rows** using SQL?
10. What are **semi-joins** and **anti-joins**?

---

## 3️⃣ **ETL & Data Pipelines**

11. How would you load data from a CSV file into a SQL table efficiently?
12. Explain the difference between **ETL** and **ELT** in a modern data warehouse.
13. How do you handle **incremental data loads** in SQL?
14. How can you use SQL to perform **data deduplication** before loading into a warehouse?
15. What’s a **staging table** and why is it important in ETL?

---

## 4️⃣ **Performance Optimization**

16. What’s the difference between a **clustered** and **non-clustered index**?
17. How do you find **slow queries** in a database?
18. How do you optimize a query that has multiple joins and aggregations?
19. When should you consider **partitioning a table**?
20. What is **query plan caching** and why is it useful?

---

## 5️⃣ **Window Functions (Advanced)**

21. Write a query to calculate a **running total** of sales per customer.
22. How would you calculate a **rolling 7-day average** in SQL?
23. Explain the difference between **RANK**, **DENSE\_RANK**, and **ROW\_NUMBER**.
24. How would you find the **previous order date** for each customer?
25. What’s the purpose of the **PARTITION BY** clause?

---

## 6️⃣ **Date & Time Mastery**

26. Write a query to get the **last day of the previous month**.
27. How do you calculate the difference in days between two dates?
28. How do you extract **week number** and **day of week** from a date?
29. Write a query to find orders placed **on weekends only**.
30. How do you handle **time zone conversions** in SQL?

---

## 7️⃣ **Analytical SQL**

31. How would you find the **top N products by revenue** per category?
32. Write a query to calculate the **year-over-year growth** in sales.
33. How do you find the **percentage contribution** of each department’s sales?
34. Write a query to identify **customers who made purchases in every month** of the year.
35. How do you use **pivot tables** in SQL?

---

## 8️⃣ **JSON & Semi-Structured Data**

36. How do you extract a **nested JSON field** in SQL?
37. Write a query to find all rows where a JSON array contains a specific value.
38. How do you flatten a JSON structure into relational columns?
39. Explain the use of the `::` cast operator in JSON extraction.
40. How do you filter rows where a **JSON key exists**?

---

## 9️⃣ **Data Governance & Security**

41. How do you mask sensitive data in SQL (e.g., show only last 4 digits of SSN)?
42. What’s the difference between **GRANT** and **REVOKE** permissions?
43. How do you implement **row-level security**?
44. How do you audit queries that modified data in a table?
45. What’s the difference between **views** and **materialized views**?

---

## 🔟 **Big Data SQL & Warehousing**

46. Explain **MPP** (Massively Parallel Processing) and its role in warehouses like Snowflake.
47. What is the difference between **hot**, **warm**, and **cold** data storage?
48. How do you use **COPY INTO** in Snowflake or Redshift to load data?
49. What are the pros and cons of **partition pruning**?
50. How would you design a query to process **billions of rows efficiently**?

---

## 🏆 **Bonus Practical Challenges**

51. Write a query to find the **second highest salary** without using `LIMIT`.
52. Write a query to detect **gaps in sequential IDs**.
53. How do you find orders where **order total > average total of all orders**?
54. Write a query to flag customers who made **back-to-back purchases** on consecutive days.
55. Create a query to **bucket customers** into spend categories: Low, Medium, High.

--
